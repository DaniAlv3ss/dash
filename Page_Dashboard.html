<div class="flex justify-end mb-6 relative">
    <div class="date-dropdown">
        <button id="date-range-toggle" class="bg-white text-slate-700 border border-slate-300 px-4 py-2 rounded-md flex items-center gap-2">
            <span id="date-range-display">Carregando...</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z"/></svg>
        </button>
        <div id="date-range-popup" class="date-popup">
            <div class="date-inputs">
                <div><label for="startDate">Data Início</label><input type="date" id="startDate"></div>
                <div><label for="endDate">Data Fim</label><input type="date" id="endDate"></div>
            </div>
            <div class="popup-actions">
                <button id="cancelButton" class="cancel-button">Cancelar</button>
                <button id="applyButton" class="apply-button">Aplicar</button>
            </div>
        </div>
    </div>
</div>

<div id="loader" class="text-center py-20">
    <p class="text-lg font-semibold text-orange-500">Carregando dados do dashboard...</p>
</div>

<div id="dashboard-content" style="visibility: hidden;">
    <section class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
        <div class="bg-white p-6 rounded-xl shadow-sm flex flex-col justify-center">
            <div class="flex justify-between items-start mb-4">
                <h2 class="text-base font-semibold text-slate-600">NPS do Período</h2>
                <div class="text-xs text-slate-400">Base: <strong id="registros-periodo">0</strong></div>
            </div>
            <div class="flex flex-grow items-center justify-center gap-4">
                <div class="flex items-center gap-2">
                    <span id="nps-periodo-score" class="text-6xl font-bold text-slate-900">0.0</span>
                    <div id="trend-indicator" class="flex flex-col items-center">
                        <svg id="trend-up-icon" style="display: none;" class="w-6 h-6 text-emerald-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M4.5 15.75l7.5-7.5 7.5 7.5" /></svg>
                        <svg id="trend-down-icon" style="display: none;" class="w-6 h-6 text-red-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" /></svg>
                    </div>
                </div>
            </div>
             <div class="border-t border-slate-100 mt-4 pt-4 space-y-2">
                <div class="flex justify-between items-center text-sm">
                    <div class="flex items-center"><span class="h-2.5 w-2.5 rounded-full bg-emerald-500 mr-2"></span>Promotores</div>
                    <strong id="promoters-periodo" class="font-bold text-slate-800">0</strong>
                </div>
                <div class="flex justify-between items-center text-sm">
                    <div class="flex items-center"><span class="h-2.5 w-2.5 rounded-full bg-amber-500 mr-2"></span>Neutros</div>
                    <strong id="neutrals-periodo" class="font-bold text-slate-800">0</strong>
                </div>
                <div class="flex justify-between items-center text-sm">
                   <div class="flex items-center"><span class="h-2.5 w-2.5 rounded-full bg-red-500 mr-2"></span>Detratores</div>
                    <strong id="detractors-periodo" class="font-bold text-slate-800">0</strong>
                </div>
            </div>
        </div>

        <div class="bg-white p-6 rounded-xl shadow-sm flex flex-col items-center justify-center">
            <h2 class="text-base font-semibold text-slate-600">NPS Acumulado (Ano)</h2>
            <div id="gauge-acumulado" class="arc-gauge-container">
                <svg viewBox="0 0 100 50" class="arc-gauge-svg"><path class="arc-gauge-track" d="M 10 50 A 40 40 0 0 1 90 50"></path><path class="arc-gauge-fill" d="M 10 50 A 40 40 0 0 1 90 50"></path></svg>
                <div class="arc-gauge-value text-slate-800">0.0</div>
            </div>
            <div class="text-center text-xs text-slate-400 mt-2">Base: <strong id="registros-acumulado">0</strong> respostas</div>
        </div>

        <div class="bg-white p-6 rounded-xl shadow-sm flex flex-col items-center justify-center">
            <h2 class="text-base font-semibold text-slate-600">Progresso da Meta</h2>
            <div id="gauge-meta" class="arc-gauge-container">
                <svg viewBox="0 0 100 50" class="arc-gauge-svg"><path class="arc-gauge-track" d="M 10 50 A 40 40 0 0 1 90 50"></path><path class="arc-gauge-fill" d="M 10 50 A 40 40 0 0 1 90 50"></path></svg>
                <div class="arc-gauge-value text-slate-800">0.0</div>
            </div>
            <div class="text-center text-xs text-slate-400 mt-2">Meta: <strong id="meta-percentage">0%</strong> | Base: <strong id="registros-meta">0</strong></div>
        </div>
    </section>

    <div class="bg-white p-6 rounded-xl shadow-sm mb-6 relative">
        <div id="evolution_chart_loader" style="display: none; position: absolute; background: rgba(255,255,255,0.8); width: 100%; height: 100%; top:0; left:0; display:flex; justify-content:center; align-items:center; z-index: 5;">Carregando...</div>
        <div class="chart-controls flex justify-end items-center gap-2 mb-2">
            <button id="backToMonthly" style="display: none;" class="text-sm px-3 py-1 bg-slate-200 rounded-md">&larr; Voltar</button>
            <div class="date-dropdown relative">
                <button id="date-range-toggle-evolution" class="bg-white text-slate-700 border border-slate-300 px-3 py-1 rounded-md flex items-center gap-2 text-sm">
                    <span id="date-range-display-evolution"></span>
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 16 16"><path d="M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z"/></svg>
                </button>
                <div id="date-range-popup-evolution" class="date-popup">
                    <div class="date-inputs">
                        <div><label for="startDateEvolution">Data Início</label><input type="date" id="startDateEvolution"></div>
                        <div><label for="endDateEvolution">Data Fim</label><input type="date" id="endDateEvolution"></div>
                    </div>
                    <div class="popup-actions">
                        <button id="cancelButtonEvolution" class="cancel-button">Cancelar</button>
                        <button id="applyButtonEvolution" class="apply-button">Aplicar</button>
                    </div>
                </div>
            </div>
        </div>
        <h2 class="text-lg font-semibold text-slate-800 text-center" id="evolution-title">Evolução NPS</h2>
        <span id="evolution-subtitle" class="text-xs text-slate-500 text-center block mb-2"></span>
        <div id="evolution_chart" style="width: 100%; height: 400px;"></div>
    </div>
    
    <section class="bg-white p-6 rounded-xl shadow-sm mb-6">
        <div class="flex flex-col md:flex-row justify-between md:items-center mb-4">
            <div>
                <h3 class="text-lg font-semibold text-slate-800">Performance Semanal vs. Ações Estratégicas</h3>
                <p class="text-sm text-slate-500">Análise da variação do NPS, detratores e neutros em relação às ações tomadas.</p>
            </div>
            <div class="date-dropdown relative mt-4 md:mt-0">
                <button id="timeline-date-range-toggle" class="bg-white text-slate-700 border border-slate-300 px-3 py-1 rounded-md flex items-center gap-2 text-sm">
                    <span id="timeline-date-range-display">Últimas 4 semanas</span>
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 16 16"><path d="M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z"/></svg>
                </button>
                <div id="timeline-date-range-popup" class="date-popup">
                    <div class="date-inputs">
                        <div><label for="timeline-startDate">Data Início</label><input type="date" id="timeline-startDate"></div>
                        <div><label for="timeline-endDate">Data Fim</label><input type="date" id="timeline-endDate"></div>
                    </div>
                    <div class="popup-actions">
                        <button id="timeline-cancelButton" class="cancel-button">Cancelar</button>
                        <button id="timeline-applyButton" class="apply-button">Aplicar</button>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="performance-graph-card" class="bg-slate-50 border border-slate-200 rounded-lg p-4 mb-6">
            <h4 class="text-md font-semibold text-slate-700 mb-2">Gráfico de Performance</h4>
            <div id="nps-timeline-loader" class="text-center py-10">
                <p class="text-slate-500">Carregando dados da timeline...</p>
            </div>
            <div id="nps-timeline-container" class="mt-2" style="display: none;">
                </div>
        </div>

        <div id="actions-timeline-card" class="bg-slate-50 border border-slate-200 rounded-lg p-4" style="display: none;">
             <div id="recent-actions-container">
                </div>
        </div>
    </section>

    <section class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
        <div class="lg:col-span-2 bg-white p-6 rounded-xl shadow-sm">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-lg font-semibold text-slate-900">Principais Motivos Apontados (Período)</h2>
                <button onclick="openHeatmapModal()" class="px-3 py-1 text-xs font-semibold text-white bg-blue-600 rounded-full hover:bg-blue-700 transition-colors flex items-center gap-1">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 1v4m0 0h-4m4 0l-5-5" /></svg>
                    Ver Detalhes
                </button>
            </div>
            <div id="motives-container" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="bg-slate-50 p-4 rounded-lg"><h3 class="font-semibold text-slate-800 mb-2">1 - Funcionamento do PC</h3><ul id="motives-funcionamento" class="space-y-3"></ul></div>
                <div class="bg-slate-50 p-4 rounded-lg"><h3 class="font-semibold text-slate-800 mb-2">2 - Qualidade de Montagem</h3><ul id="motives-montagem" class="space-y-3"></ul></div>
                <div class="bg-slate-50 p-4 rounded-lg"><h3 class="font-semibold text-slate-800 mb-2">3 - Visual do PC</h3><ul id="motives-visual" class="space-y-3"></ul></div>
                <div class="bg-slate-50 p-4 rounded-lg"><h3 class="font-semibold text-slate-800 mb-2">4 - Transporte</h3><ul id="motives-transporte" class="space-y-3"></ul></div>
            </div>
        </div>
        <div class="bg-white p-6 rounded-xl shadow-sm">
            <h2 class="text-lg font-semibold text-slate-900 mb-4">Detratores com Chamado no Suporte</h2>
            <div id="detractors-support-container" class="space-y-3"></div>
        </div>
    </section>

    <div class="bg-white p-6 rounded-xl shadow-sm mb-6">
        <div class="flex flex-col sm:flex-row justify-between sm:items-center mb-4">
            <div>
                <h2 class="text-lg font-semibold text-slate-900">Comentários do Período</h2>
                <div id="filter-status" style="display: none;" class="items-center text-orange-700 text-xs font-semibold mt-1"><span id="filter-status-text"></span><button id="clear-filter-btn" class="ml-2 font-bold text-lg leading-none">&times;</button></div>
            </div>
            <div class="flex items-center gap-4 mt-3 sm:mt-0">
                <div id="classification-filters" class="flex items-center gap-2">
                    <button onclick="toggleClassificationFilter('promotor', this)" class="classification-filter-btn px-3 py-1 text-xs font-semibold text-slate-600 bg-slate-100 rounded-full hover:bg-slate-200 transition-colors">Promotores</button>
                    <button onclick="toggleClassificationFilter('neutro', this)" class="classification-filter-btn px-3 py-1 text-xs font-semibold text-slate-600 bg-slate-100 rounded-full hover:bg-slate-200 transition-colors">Neutros</button>
                    <button onclick="toggleClassificationFilter('detrator', this)" class="classification-filter-btn px-3 py-1 text-xs font-semibold text-slate-600 bg-slate-100 rounded-full hover:bg-slate-200 transition-colors">Detratores</button>
                </div>
                <button id="export-comments-btn" class="px-3 py-1 text-xs font-semibold text-white bg-emerald-600 rounded-full hover:bg-emerald-700 transition-colors flex items-center gap-1"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" /></svg>Exportar</button>
            </div>
        </div>
        <div class="table-wrapper"><table id="responses-table" class="w-full text-sm text-left text-slate-500"><thead class="text-xs text-slate-700 uppercase bg-slate-50 sticky top-0"><tr><th class="px-6 py-3">Data</th><th class="px-6 py-3">Pedido</th><th class="px-6 py-3">OS</th><th class="px-6 py-3">Cliente</th><th class="px-6 py-3">Classificação</th><th class="px-6 py-3">Comentário</th></tr></thead><tbody id="responses-table-body"></tbody></table></div>
        <div class="pagination-controls flex justify-end items-center mt-4 text-sm"><span id="page-info"></span><div class="ml-4"><button id="prev-page" class="px-3 py-1 border border-slate-300 rounded-md hover:bg-slate-100 disabled:opacity-50">&lt;</button><button id="next-page" class="px-3 py-1 border border-slate-300 rounded-md hover:bg-slate-100 disabled:opacity-50 ml-2">&gt;</button></div></div>
    </div>

    <section id="word-analysis-section" class="mb-6" style="display: none;">
        <h2 class="text-lg font-semibold text-slate-900 mb-4">Análise de Termos nos Comentários</h2>
        <div id="word-analysis-loader" class="text-center py-10 bg-white rounded-xl shadow-sm"><p class="text-sm font-semibold text-slate-500">Analisando termos...</p></div>
        <div id="word-analysis-content" class="hidden grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
            <div class="bg-white p-6 rounded-xl shadow-sm"><h3 class="font-semibold text-slate-800 mb-4">Funcionamento do PC</h3><ul id="word-analysis-funcionamento" class="space-y-4"></ul></div>
            <div class="bg-white p-6 rounded-xl shadow-sm"><h3 class="font-semibold text-slate-800 mb-4">Qualidade de Montagem</h3><ul id="word-analysis-montagem" class="space-y-4"></ul></div>
            <div class="bg-white p-6 rounded-xl shadow-sm"><h3 class="font-semibold text-slate-800 mb-4">Visual do PC</h3><ul id="word-analysis-visual" class="space-y-4"></ul></div>
            <div class="bg-white p-6 rounded-xl shadow-sm"><h3 class="font-semibold text-slate-800 mb-4">Transporte</h3><ul id="word-analysis-transporte" class="space-y-4"></ul></div>
        </div>
    </section>

<div id="support-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden items-center justify-center p-4" onclick="closeSupportModal()"><div id="support-modal-content" class="bg-white rounded-xl shadow-2xl w-full max-w-6xl transform scale-95" onclick="event.stopPropagation()"><div class="p-6 border-b"><div class="flex justify-between items-center"><h2 class="text-xl font-semibold text-slate-800">Detalhes de Chamados no Suporte</h2><div class="flex items-center gap-4"><button id="export-support-btn" class="px-3 py-1 text-xs font-semibold text-white bg-emerald-600 rounded-full hover:bg-emerald-700 transition-colors flex items-center gap-1"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" /></svg>Exportar</button><button onclick="closeSupportModal()" class="text-slate-400 hover:text-slate-600 text-2xl font-bold">&times;</button></div></div><div id="support-modal-filters" class="flex flex-wrap gap-2 mt-4"></div></div><div class="p-6"><div id="support-modal-loader" class="text-center py-10">Carregando...</div><div id="support-modal-table-container" class="modal-table-wrapper hidden"><table class="w-full text-sm text-left text-slate-500"><thead class="text-xs text-slate-700 uppercase bg-slate-50 sticky top-0"><tr><th class="px-4 py-3">Data Avaliação</th><th class="px-4 py-3">Pedido</th><th class="px-4 py-3">OS</th><th class="px-4 py-3">Cliente</th><th class="px-4 py-3">Classificação</th><th class="px-4 py-3">Comentário</th><th class="px-4 py-3">Resolução</th><th class="px-4 py-3">Defeito</th><th class="px-4 py-3">Relato do Cliente</th></tr></thead><tbody id="support-modal-table-body"></tbody></table></div></div></div></div>
    <div id="word-context-modal" class="fixed inset-0 bg-black bg-opacity-60 z-[60] hidden items-center justify-center p-4" onclick="closeWordContextModal()"><div id="word-context-modal-content" class="bg-white rounded-xl shadow-2xl w-full max-w-6xl transform scale-95" onclick="event.stopPropagation()"><div class="p-6 border-b"><div class="flex justify-between items-center"><h2 id="word-context-modal-title" class="text-xl font-semibold text-slate-800"></h2><button onclick="closeWordContextModal()" class="text-slate-400 hover:text-slate-600 text-2xl font-bold">&times;</button></div></div><div class="p-6"><div class="modal-table-wrapper"><table class="w-full text-sm text-left text-slate-500"><thead class="text-xs text-slate-700 uppercase bg-slate-50 sticky top-0"><tr><th class="px-4 py-3">Data</th><th class="px-4 py-3">Pedido</th><th class="px-4 py-3">OS</th><th class="px-4 py-3">Cliente</th><th class="px-4 py-3">Classificação</th><th class="px-4 py-3">Comentário</th></tr></thead><tbody id="word-context-modal-table-body"></tbody></table></div></div></div></div>
    <button id="floating-ai-btn" onclick="openAiModal()" class="fixed bottom-8 right-8 z-40 bg-cyan-500 text-slate-900 rounded-full p-4 shadow-lg hover:scale-110 transition-transform"><svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.573L16.5 21.75l-.398-1.177a3.375 3.375 0 00-2.455-2.456L12.75 18l1.177-.398a3.375 3.375 0 002.455-2.456L16.5 14.25l.398 1.177a3.375 3.375 0 002.456 2.456L20.25 18l-1.177.398a3.375 3.375 0 00-2.456 2.456z" /></svg></button>
    <div id="ai-modal-overlay" class="fixed inset-0 bg-slate-900/70 z-50 hidden transition-opacity" onclick="closeAiModal()"><div id="ai-modal-panel" class="fixed top-0 right-0 bottom-0 w-full max-w-3xl bg-slate-800 text-white transform translate-x-full transition-transform flex flex-col" onclick="event.stopPropagation()"><div class="flex justify-between items-center p-4 border-b border-slate-700 flex-shrink-0"><div class="flex items-center gap-3"><svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7 text-cyan-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09z" /></svg><h2 class="text-lg font-semibold">Hub de Análises com IA</h2></div><div class="flex items-center gap-2"><button id="export-ai-btn" onclick="exportAiAnalysis()" class="px-3 py-1 text-xs font-semibold text-slate-900 bg-cyan-400 rounded-full hover:bg-cyan-300 transition-colors flex items-center gap-1 disabled:opacity-50 disabled:cursor-not-allowed" disabled><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" /></svg>Exportar Análise</button><button onclick="closeAiModal()" class="text-slate-400 hover:text-white text-2xl font-bold">&times;</button></div></div><div id="ai-modal-body" class="flex-grow overflow-y-auto p-6"><div class="border-b border-slate-700 mb-4"><nav class="-mb-px flex space-x-6 overflow-x-auto"><button onclick="switchAiTab('problems')" id="tab-problems" class="ai-tab whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm border-transparent text-slate-400 hover:text-white hover:border-slate-300">Análise de Problemas</button><button onclick="switchAiTab('topics')" id="tab-topics" class="ai-tab whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm border-transparent text-slate-400 hover:text-white hover:border-slate-300">Principais Tópicos</button><button onclick="switchAiTab('praises')" id="tab-praises" class="ai-tab whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm border-transparent text-slate-400 hover:text-white hover:border-slate-300">Pontos Fortes</button></nav></div><div id="ai-hub-initial" class="text-center p-8"><h3 class="text-lg font-semibold text-white">Bem-vindo ao Hub de Análises</h3><p class="text-slate-400 mt-2 text-sm">Selecione uma das abas acima para gerar insights sobre os comentários do período selecionado.</p></div><div id="content-problems" class="ai-tab-content"><div class="ai-placeholder text-center p-8"><h4 class="font-semibold text-slate-300">Análise de Problemas e Sugestões</h4><p class="text-slate-400 mt-2 text-sm">Clique no botão abaixo para que a IA identifique os problemas mais recorrentes e sugira ações corretivas.</p><button onclick="runAnalysisForTab('problems')" class="mt-4 bg-cyan-500 text-slate-900 font-semibold px-4 py-2 rounded-md hover:bg-cyan-400 transition-colors">Analisar Problemas</button></div><div class="ai-results-container" style="display: none;"><div class="grid grid-cols-1 md:grid-cols-2 gap-6"><div><h3 class="font-semibold text-red-400 mb-3 flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>Problemas Recorrentes</h3><div id="problems-list" class="space-y-4"></div></div><div><h3 class="font-semibold text-amber-400 mb-3 flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.375 3.375 0 0112 18.25a3.375 3.375 0 01-2.702-.981l-.547-.547z" /></svg>Sugestões de Ações</h3><div id="solutions-list" class="space-y-4"></div></div></div></div></div><div id="content-topics" class="ai-tab-content"><div class="ai-placeholder text-center p-8"><h4 class="font-semibold text-slate-300">Análise de Tópicos</h4><p class="text-slate-400 mt-2 text-sm">Clique no botão abaixo para que a IA identifique e quantifique os principais tópicos mencionados nos comentários.</p><button onclick="runAnalysisForTab('topics')" class="mt-4 bg-cyan-500 text-slate-900 font-semibold px-4 py-2 rounded-md hover:bg-cyan-400 transition-colors">Analisar Tópicos</button></div><div class="ai-results-container" style="display: none;"><h3 class="font-semibold text-cyan-400 mb-3 flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9 13h6m-3-3v6m-9 1V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v8a2 2 0 01-2 2H5a2 2 0 01-2-2z" /></svg>Principais Tópicos por Sentimento</h3><div id="topics-list" class="space-y-4"></div></div></div><div id="content-praises" class="ai-tab-content"><div class="ai-placeholder text-center p-8"><h4 class="font-semibold text-slate-300">Análise de Pontos Fortes</h4><p class="text-slate-400 mt-2 text-sm">Clique no botão abaixo para que a IA identifique os principais elogios e pontos fortes mencionados pelos clientes.</p><button onclick="runAnalysisForTab('praises')" class="mt-4 bg-cyan-500 text-slate-900 font-semibold px-4 py-2 rounded-md hover:bg-cyan-400 transition-colors">Analisar Pontos Fortes</button></div><div class="ai-results-container" style="display: none;"><h3 class="font-semibold text-emerald-400 mb-3 flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14 10h4.764a2 2 0 011.789 2.894l-3.5 7A2 2 0 0115.263 21h-4.017c-.163 0-.326-.02-.485-.06L7 20m7-10V5a2 2 0 00-2-2h-.085a2 2 0 00-1.764.97L5.5 8m7 2h2v4h-2v-4z" /></svg>Elogios e Pontos Fortes</h3><div id="praises-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"></div></div></div><div id="ai-tab-loader" style="display: none;" class="flex justify-center items-center py-8"><svg class="animate-spin h-6 w-6 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg><p class="text-sm text-slate-300 ml-3">Analisando...</p></div></div></div></div>

    <!-- MODAL PARA HEATMAP -->
    <div id="heatmap-modal" class="fixed inset-0 bg-black bg-opacity-60 z-[60] hidden items-center justify-center p-4" onclick="closeHeatmapModal()">
        <div id="heatmap-modal-content" class="bg-slate-50 rounded-xl shadow-2xl w-full max-w-7xl h-[95vh] flex flex-col transform scale-95" onclick="event.stopPropagation()">
            <div class="p-4 border-b border-slate-200 bg-white rounded-t-xl flex-shrink-0">
                <div class="flex flex-col sm:flex-row justify-between sm:items-center">
                    <div>
                        <h1 class="text-xl font-bold text-slate-800 tracking-tight">Relatório de Avaliação de Qualidade</h1>
                        <p class="text-sm text-slate-500 mt-1">Análise de problemas por categoria e mês</p>
                    </div>
                    <button onclick="closeHeatmapModal()" class="text-slate-400 hover:text-slate-600 text-2xl font-bold self-start sm:self-center">&times;</button>
                </div>
                 <div id="heatmap-filters" class="flex flex-col sm:flex-row items-start sm:items-center gap-4 mt-4">
                    <div>
                        <label for="heatmap-month-picker" class="text-sm font-medium text-slate-700 mr-2">Mês de Referência:</label>
                        <input type="month" id="heatmap-month-picker" class="border border-slate-300 rounded-md px-2 py-1 text-sm">
                    </div>
                    <div class="flex items-center gap-2" id="heatmap-classification-filters">
                        <button data-classification="promotor" class="heatmap-filter-btn px-3 py-1 text-xs font-semibold rounded-full">Promotores</button>
                        <button data-classification="neutro" class="heatmap-filter-btn px-3 py-1 text-xs font-semibold rounded-full">Neutros</button>
                        <button data-classification="detrator" class="heatmap-filter-btn px-3 py-1 text-xs font-semibold rounded-full">Detratores</button>
                    </div>
                </div>
            </div>
            <div id="heatmap-modal-body" class="p-4 overflow-auto">
                <div id="heatmap-loader" class="text-center py-20"><p class="text-slate-500">Carregando dados do heatmap...</p></div>
                <div id="heatmap-container" class="hidden bg-white rounded-lg shadow-md border overflow-hidden">
                    <table class="w-full text-sm" id="heatmap-table">
                        <thead id="heatmap-thead" class="bg-slate-50 sticky top-0 z-10">
                            <!-- Header will be generated by JS -->
                        </thead>
                        <tbody id="heatmap-tbody" class="divide-y divide-slate-200">
                            <!-- Rows will be generated by JS -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
